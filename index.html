<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Anime Player</title>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/artplayer/dist/artplayer.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        body { margin: 0; padding: 0; background: #000; overflow: hidden; }
        #player { width: 100vw; height: 100vh; }
        
        /* Custom styling for the Skip Button */
        #skip-btn {
            display: none;
            position: absolute;
            bottom: 80px;
            right: 20px;
            z-index: 20;
            background: rgba(255, 173, 0, 0.9);
            color: black;
            font-weight: bold;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
        }
        #skip-btn:hover { transform: scale(1.1); background: #fff; }
    </style>
</head>
<body>

    <div id="player"></div>
    <div id="skip-btn">SKIP INTRO</div>

    <script>
        // YOUR API DATA (This would normally come from your fetch call)
        const apiResponse = {
            "streamingLink": {
                "link": { "file": "https://haildrop77.pro/_v7/.../master.m3u8" },
                "tracks": [
                    { "file": "https://mgstatics.xyz/subtitle/.../eng-2.vtt", "label": "English", "default": true }
                ],
                "intro": { "start": 0, "end": 89 },
                "outro": { "start": 1460, "end": 1549 }
            }
        };

        const stream = apiResponse.streamingLink;
        const skipBtn = document.getElementById('skip-btn');

        // 1. Initialize ArtPlayer
        const art = new Artplayer({
            container: '#player',
            url: stream.link.file,
            type: 'm3u8',
            fullscreen: true,
            setting: true,
            pip: true,
            playbackRate: true,
            aspectRatio: true,
            theme: '#ffad00', // Megaplay-style yellow/orange
            
            // 2. Custom Icons (Replace URLs with your SVG/PNG paths)
            icons: {
                loading: '<img width="60" src="https://artplayer.org/assets/img/ploading.gif">',
                state: '<img width="150" src="https://artplayer.org/assets/img/state.svg">',
            },

            // 3. HLS Support
            customType: {
                m3u8: function (video, url) {
                    if (Hls.isSupported()) {
                        const hls = new Hls();
                        hls.loadSource(url);
                        hls.attachMedia(video);
                    } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
                        video.src = url;
                    }
                },
            },

            // 4. Subtitles
            subtitle: {
                url: stream.tracks.find(t => t.default)?.file || '',
                type: 'vtt',
                style: {
                    color: '#fff',
                    fontSize: '24px',
                    textShadow: '0 0 4px rgba(0,0,0,1)'
                },
            },

            // 5. Timeline Markers (Visual dots for Intro/Outro)
            highlight: [
                { time: stream.intro.start, text: 'Intro' },
                { time: stream.outro.start, text: 'Outro' },
            ],
        });

        // 6. Skip Intro Logic
        art.on('video:timeupdate', () => {
            const currentTime = art.currentTime;
            
            // Show skip button if within intro range
            if (currentTime >= stream.intro.start && currentTime <= stream.intro.end) {
                skipBtn.style.display = 'block';
            } else {
                skipBtn.style.display = 'none';
            }
        });

        skipBtn.onclick = () => {
            art.currentTime = stream.intro.end;
            skipBtn.style.display = 'none';
            art.notice.show = 'Skipped Intro';
        };

        // 7. Auto-Skip Outro (Optional)
        art.on('video:timeupdate', () => {
            if (art.currentTime >= stream.outro.start) {
                art.notice.show = 'Outro Started - Up Next in 5s...';
                // You can add auto-next logic here
            }
        });

    </script>
</body>
</html>
